<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WabiSaby</title>
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
    <link rel="alternate icon" href="../assets/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="bg-overlay"></div>
    <div class="container" id="main-container">
        <!-- Navbar component will be loaded here -->
        <div data-component="navbar.html"></div>

        <main class="dashboard-grid">
            <section id="now-playing" class="card full-width now-playing-card">
                <!-- Visualizer Background -->
                <div class="np-visualizer-bg">
                    <canvas id="visualizer-canvas"></canvas>
                </div>

                <!-- Main Content -->
                <div class="np-content">
                    <!-- Left: Album Art -->
                    <div class="np-artwork-container">
                        <div id="np-artwork" class="np-artwork">
                            <i class="fas fa-compact-disc np-artwork-placeholder"></i>
                        </div>
                    </div>

                    <!-- Center: Song Info & Progress -->
                    <div class="np-info">
                        <div id="current-song-info" class="np-song-details">
                            <div class="np-idle-state">
                                <span class="np-idle-label" data-i18n="ui.dashboard.nowPlaying.readyToPlay">READY TO
                                    PLAY</span>
                                <p class="np-idle-hint" data-i18n="ui.dashboard.nowPlaying.addTrackHint">Add a track to
                                    get started</p>
                            </div>
                        </div>

                        <div id="progress-section" class="np-progress hidden">
                            <div class="np-progress-bar-container">
                                <div id="progress-bar" class="np-progress-bar"></div>
                            </div>
                            <div class="np-time-display">
                                <span id="current-time">0:00</span>
                                <span id="total-time">0:00</span>
                            </div>
                        </div>
                    </div>

                    <!-- Right: Controls -->
                    <div class="np-controls">
                        <button id="play-pause-btn" class="np-control-btn" title="Pause"
                            data-i18n-title="ui.dashboard.nowPlaying.pause">
                            <i class="fas fa-pause"></i>
                        </button>
                        <button id="skip-btn" class="np-control-btn np-skip-btn" title="Skip"
                            data-i18n-title="ui.dashboard.nowPlaying.skip">
                            <i class="fas fa-forward"></i>
                        </button>
                        <button id="shuffle-btn" class="np-control-btn" title="Shuffle Mode"
                            data-i18n-title="ui.dashboard.settings.playback.shuffleEnabled">
                            <i class="fas fa-random"></i>
                        </button>
                        <button id="repeat-btn" class="np-control-btn" title="Repeat Mode"
                            data-i18n-title="ui.dashboard.settings.playback.repeatMode">
                            <i class="fas fa-repeat"></i>
                        </button>
                        <!-- Volume Control -->
                        <div class="np-volume-control">
                            <button class="np-volume-btn" id="volume-toggle-btn" title="Volume" aria-label="Volume">
                                <i class="fas fa-volume-up" id="volume-icon"></i>
                            </button>
                            <div class="np-volume-slider-wrapper">
                                <input type="range" id="volume-slider" min="0" max="100" value="100" step="1"
                                    aria-label="Volume" />
                                <span class="np-volume-value" id="volume-value">100%</span>
                            </div>
                        </div>
                        <button id="fullscreen-btn" class="np-control-btn np-fullscreen-btn" title="Fullscreen"
                            data-i18n-title="ui.dashboard.nowPlaying.fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
            </section>

            <section id="queue" class="card full-width">
                <div class="card-header" style="justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <i class="fas fa-list"></i>
                        <h2 data-i18n="ui.dashboard.queue.title">Up Next</h2>
                        <span class="badge" id="queue-count">0</span>
                    </div>
                    <div class="queue-header-actions">
                        <button id="prefetch-btn" class="cyber-btn small queue-action-btn"
                            title="Download all songs in queue" data-i18n-title="ui.dashboard.queue.prefetchAll">
                            <i class="fas fa-download"></i> <span data-i18n="ui.dashboard.queue.prefetchAll">PREFETCH
                                ALL</span>
                        </button>
                        <button id="add-song-btn" class="cyber-btn primary small add-track-btn queue-action-btn"
                            title="Add a track" data-i18n-title="ui.dashboard.queue.addTrack">
                            <i class="fas fa-plus"></i> <span data-i18n="ui.dashboard.queue.addTrack">ADD TRACK</span>
                        </button>
                    </div>
                </div>
                <div class="queue-container">
                    <ul id="queue-list">
                        <!-- Queue items populated here -->
                    </ul>
                </div>
            </section>

            <!-- Audio Effects Card -->
            <section id="effects-card" class="card full-width effects-card">
                <div class="card-header" style="justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <i class="fas fa-sliders-h"></i>
                        <h2 data-i18n="ui.dashboard.effects.title">Audio Effects</h2>
                        <div class="effects-active-badge" id="effects-active-badge">
                            <span class="preset-name" data-i18n="ui.dashboard.effects.normal">Normal</span>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <button type="button" id="effects-mode-toggle" class="cyber-btn small"
                            title="Toggle Simple/Advanced Mode"
                            data-i18n-title="ui.dashboard.effects.toggleSimpleAdvanced">
                            <i class="fas fa-sliders-h"></i>
                            <span id="effects-mode-label" data-i18n="ui.dashboard.effects.simple">Simple</span>
                        </button>
                        <button type="button" id="effects-reset-all"
                            class="cyber-btn small danger effects-reset-all-btn" title="Reset All Effects"
                            data-i18n-title="ui.dashboard.effects.resetAllEffects">
                            <i class="fas fa-undo"></i>
                            <span data-i18n="ui.dashboard.effects.resetAll">RESET ALL</span>
                        </button>
                        <label class="toggle-switch-v2">
                            <input type="checkbox" id="effects-enabled" checked>
                            <span class="toggle-track">
                                <span class="toggle-thumb"></span>
                            </span>
                        </label>
                        <button id="effects-expand-btn" class="cyber-btn small" title="Expand Effects"
                            style="width: auto; padding: 8px;" data-i18n-title="ui.dashboard.effects.expandEffects">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>

                <!-- Presets Row (always visible) -->
                <div class="effects-presets-row">
                    <div class="effects-presets-grid" id="effects-presets-grid">
                        <!-- Presets populated by JavaScript -->
                    </div>
                </div>

                <!-- Quick Adjustments Row (Simple Mode) -->
                <div class="effects-quick-adjustments-row" id="effects-quick-adjustments-row">
                    <div class="effects-quick-adjustments">
                        <button class="quick-adjust-btn" data-action="bass-up" title="Increase Bass"
                            data-i18n-title="ui.dashboard.effects.bassUp">
                            <i class="fas fa-volume-up"></i>
                            <span data-i18n="ui.dashboard.effects.bassUp">Bass+</span>
                        </button>
                        <button class="quick-adjust-btn" data-action="bass-down" title="Decrease Bass"
                            data-i18n-title="ui.dashboard.effects.bassDown">
                            <i class="fas fa-volume-down"></i>
                            <span data-i18n="ui.dashboard.effects.bassDown">Bass-</span>
                        </button>
                        <button class="quick-adjust-btn" data-action="reverb-up" title="Increase Reverb"
                            data-i18n-title="ui.dashboard.effects.reverbUp">
                            <i class="fas fa-water"></i>
                            <span data-i18n="ui.dashboard.effects.reverbUp">Reverb+</span>
                        </button>
                        <button class="quick-adjust-btn" data-action="reverb-down" title="Decrease Reverb"
                            data-i18n-title="ui.dashboard.effects.reverbDown">
                            <i class="fas fa-water"></i>
                            <span data-i18n="ui.dashboard.effects.reverbDown">Reverb-</span>
                        </button>
                        <button class="quick-adjust-btn" data-action="faster" title="Speed Up"
                            data-i18n-title="ui.dashboard.effects.faster">
                            <i class="fas fa-forward"></i>
                            <span data-i18n="ui.dashboard.effects.faster">Faster</span>
                        </button>
                        <button class="quick-adjust-btn" data-action="slower" title="Slow Down"
                            data-i18n-title="ui.dashboard.effects.slower">
                            <i class="fas fa-backward"></i>
                            <span data-i18n="ui.dashboard.effects.slower">Slower</span>
                        </button>
                    </div>
                </div>

                <!-- Expandable Content -->
                <div class="effects-expanded-content" id="effects-expanded-content">
                    <!-- Simple Mode - Just show a hint -->
                    <div class="effects-simple-mode" id="effects-simple-mode">
                        <div class="effects-simple-content">
                            <p class="effects-simple-hint" data-i18n="ui.dashboard.effects.simpleModeHint">Use the quick
                                adjustment buttons above to tweak effects, or switch to Advanced mode for full control.
                            </p>
                        </div>
                    </div>

                    <!-- Advanced Mode -->
                    <div class="effects-advanced-mode" id="effects-advanced-mode" style="display: none;">
                        <div class="effects-columns">
                            <!-- Left Column: Speed & EQ -->
                            <div class="effects-column">
                                <!-- Speed Control -->
                                <div class="effects-section compact">
                                    <div class="effects-section-header">
                                        <i class="fas fa-tachometer-alt"></i>
                                        <span data-i18n="ui.dashboard.effects.speed">Speed</span>
                                    </div>
                                    <div class="effect-slider-row">
                                        <div class="effect-slider-container">
                                            <input type="range" id="effect-speed" class="effect-slider" min="0.5"
                                                max="2" step="0.05" value="1">
                                            <span class="effect-value" id="effect-speed-value">1.0x</span>
                                        </div>
                                        <button class="effect-reset-btn" data-target="effect-speed" data-default="1"
                                            title="Reset">
                                            <i class="fas fa-undo"></i>
                                        </button>
                                    </div>
                                </div>

                                <!-- EQ Controls (Visual) -->
                                <div class="effects-section compact">
                                    <div class="effects-section-header">
                                        <i class="fas fa-sliders-h"></i>
                                        <span data-i18n="ui.dashboard.effects.equalizer">Equalizer</span>
                                    </div>
                                    <div class="effects-eq-container">
                                        <div class="eq-graphical" id="eq-graphical">
                                            <div class="eq-header-controls">
                                                <button id="eq-spectrum-toggle" class="eq-toggle-btn"
                                                    title="Toggle spectrum visualization"
                                                    data-i18n-title="ui.dashboard.effects.toggleSpectrum">
                                                    <i class="fas fa-wave-square"></i>
                                                </button>
                                            </div>
                                            <svg class="eq-curve-svg" viewBox="0 0 300 120" preserveAspectRatio="none">
                                                <defs>
                                                    <linearGradient id="eq-gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                                        <stop offset="0%" style="stop-color:#a855f7;stop-opacity:0.3" />
                                                        <stop offset="100%"
                                                            style="stop-color:#a855f7;stop-opacity:0.1" />
                                                    </linearGradient>
                                                    <linearGradient id="spectrum-gradient" x1="0%" y1="0%" x2="0%"
                                                        y2="100%">
                                                        <stop offset="0%" style="stop-color:#3b82f6;stop-opacity:0.4" />
                                                        <stop offset="100%"
                                                            style="stop-color:#3b82f6;stop-opacity:0.1" />
                                                    </linearGradient>
                                                </defs>
                                                <!-- Real-time frequency spectrum (background) -->
                                                <g id="eq-spectrum-layer" class="eq-spectrum-layer" opacity="0">
                                                    <path id="eq-spectrum-path" stroke="#3b82f6" stroke-width="1.5"
                                                        fill="url(#spectrum-gradient)" opacity="0.6" />
                                                    <path id="eq-spectrum-line" stroke="#60a5fa" stroke-width="1"
                                                        fill="none" opacity="0.8" />
                                                </g>
                                                <!-- Frequency response curve (foreground) -->
                                                <path id="eq-curve-path" d="M0,60 L75,60 L150,60 L225,60 L300,60"
                                                    stroke="#a855f7" stroke-width="2" fill="none" />
                                                <!-- Fill under curve -->
                                                <path id="eq-curve-fill"
                                                    d="M0,120 L0,60 L75,60 L150,60 L225,60 L300,60 L300,120 Z"
                                                    fill="url(#eq-gradient)" />
                                                <!-- Control points -->
                                                <circle id="eq-point-bass" cx="75" cy="60" r="6" fill="#a855f7"
                                                    class="eq-control-point" />
                                                <circle id="eq-point-mid" cx="150" cy="60" r="6" fill="#a855f7"
                                                    class="eq-control-point" />
                                                <circle id="eq-point-treble" cx="225" cy="60" r="6" fill="#a855f7"
                                                    class="eq-control-point" />
                                            </svg>
                                            <div class="eq-frequency-labels">
                                                <span>100Hz</span>
                                                <span>1kHz</span>
                                                <span>10kHz</span>
                                            </div>
                                            <div class="eq-db-labels">
                                                <span>+20</span>
                                                <span>0</span>
                                                <span>-20</span>
                                            </div>
                                        </div>
                                        <!-- Fallback sliders for mobile -->
                                        <div class="eq-fallback" id="eq-fallback" style="display: none;">
                                            <div class="eq-band-h">
                                                <label data-i18n="ui.dashboard.effects.bass">Bass</label>
                                                <input type="range" id="effect-eq-bass" class="eq-slider-h" min="-20"
                                                    max="20" step="1" value="0">
                                                <span class="eq-value-h" id="effect-eq-bass-value">0</span>
                                            </div>
                                            <div class="eq-band-h">
                                                <label data-i18n="ui.dashboard.effects.mid">Mid</label>
                                                <input type="range" id="effect-eq-mid" class="eq-slider-h" min="-20"
                                                    max="20" step="1" value="0">
                                                <span class="eq-value-h" id="effect-eq-mid-value">0</span>
                                            </div>
                                            <div class="eq-band-h">
                                                <label data-i18n="ui.dashboard.effects.treble">Treble</label>
                                                <input type="range" id="effect-eq-treble" class="eq-slider-h" min="-20"
                                                    max="20" step="1" value="0">
                                                <span class="eq-value-h" id="effect-eq-treble-value">0</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column: Effects -->
                            <div class="effects-column">
                                <div class="effects-section compact">
                                    <div class="effects-section-header">
                                        <i class="fas fa-magic"></i>
                                        <span data-i18n="ui.dashboard.effects.effects">Effects</span>
                                    </div>
                                    <div class="effects-toggles-grid">
                                        <!-- Reverb -->
                                        <div class="effect-toggle-card">
                                            <div class="effect-toggle-header">
                                                <i class="fas fa-water"></i>
                                                <span data-i18n="ui.dashboard.effects.reverb">Reverb</span>
                                                <div class="effect-header-controls">
                                                    <button class="effect-advanced-btn" data-effect="reverb"
                                                        title="Advanced Controls"
                                                        data-i18n-title="ui.dashboard.effects.advancedControls">
                                                        <i class="fas fa-cog"></i>
                                                    </button>
                                                    <label class="toggle-switch-v2 small">
                                                        <input type="checkbox" id="effect-reverb-enabled">
                                                        <span class="toggle-track"><span
                                                                class="toggle-thumb"></span></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="effect-toggle-controls" id="effect-reverb-controls">
                                                <div class="effect-intensity-control">
                                                    <div class="mini-control-header">
                                                        <span
                                                            data-i18n="ui.dashboard.effects.intensity">Intensity</span>
                                                        <span class="mini-value"
                                                            id="effect-reverb-intensity-value-adv">0%</span>
                                                    </div>
                                                    <input type="range" id="effect-reverb-intensity-adv" min="0"
                                                        max="100" step="5" value="0">
                                                </div>
                                                <div class="effect-advanced-controls" id="effect-reverb-advanced"
                                                    style="display: none;">
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.size">Size</span>
                                                            <span class="mini-value">0.5</span>
                                                        </div>
                                                        <input type="range" id="effect-reverb-roomSize" min="0.1"
                                                            max="1" step="0.1" value="0.5">
                                                    </div>
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.wet">Wet</span>
                                                            <span class="mini-value">0.3</span>
                                                        </div>
                                                        <input type="range" id="effect-reverb-wetLevel" min="0.1"
                                                            max="0.8" step="0.05" value="0.3">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Echo -->
                                        <div class="effect-toggle-card">
                                            <div class="effect-toggle-header">
                                                <i class="fas fa-broadcast-tower"></i>
                                                <span data-i18n="ui.dashboard.effects.echo">Echo</span>
                                                <div class="effect-header-controls">
                                                    <button class="effect-advanced-btn" data-effect="echo"
                                                        title="Advanced Controls"
                                                        data-i18n-title="ui.dashboard.effects.advancedControls">
                                                        <i class="fas fa-cog"></i>
                                                    </button>
                                                    <label class="toggle-switch-v2 small">
                                                        <input type="checkbox" id="effect-echo-enabled">
                                                        <span class="toggle-track"><span
                                                                class="toggle-thumb"></span></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="effect-toggle-controls" id="effect-echo-controls">
                                                <div class="effect-intensity-control">
                                                    <div class="mini-control-header">
                                                        <span
                                                            data-i18n="ui.dashboard.effects.intensity">Intensity</span>
                                                        <span class="mini-value"
                                                            id="effect-echo-intensity-value-adv">0%</span>
                                                    </div>
                                                    <input type="range" id="effect-echo-intensity-adv" min="0" max="100"
                                                        step="5" value="0">
                                                </div>
                                                <div class="effect-advanced-controls" id="effect-echo-advanced"
                                                    style="display: none;">
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.delay">Delay</span>
                                                            <span class="mini-value">300ms</span>
                                                        </div>
                                                        <input type="range" id="effect-echo-delay" min="50" max="1000"
                                                            step="50" value="300">
                                                    </div>
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.decay">Decay</span>
                                                            <span class="mini-value">0.4</span>
                                                        </div>
                                                        <input type="range" id="effect-echo-decay" min="0.1" max="0.8"
                                                            step="0.05" value="0.4">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Distortion -->
                                        <div class="effect-toggle-card">
                                            <div class="effect-toggle-header">
                                                <i class="fas fa-bolt"></i>
                                                <span data-i18n="ui.dashboard.effects.distortion">Distortion</span>
                                                <div class="effect-header-controls">
                                                    <button class="effect-advanced-btn" data-effect="distortion"
                                                        title="Advanced Controls"
                                                        data-i18n-title="ui.dashboard.effects.advancedControls">
                                                        <i class="fas fa-cog"></i>
                                                    </button>
                                                    <label class="toggle-switch-v2 small">
                                                        <input type="checkbox" id="effect-distortion-enabled">
                                                        <span class="toggle-track"><span
                                                                class="toggle-thumb"></span></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="effect-toggle-controls" id="effect-distortion-controls">
                                                <div class="effect-intensity-control">
                                                    <div class="mini-control-header">
                                                        <span
                                                            data-i18n="ui.dashboard.effects.intensity">Intensity</span>
                                                        <span class="mini-value"
                                                            id="effect-distortion-intensity-value-adv">0%</span>
                                                    </div>
                                                    <input type="range" id="effect-distortion-intensity-adv" min="0"
                                                        max="100" step="5" value="0">
                                                </div>
                                                <div class="effect-advanced-controls" id="effect-distortion-advanced"
                                                    style="display: none;">
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.drive">Drive</span>
                                                            <span class="mini-value">0.5</span>
                                                        </div>
                                                        <input type="range" id="effect-distortion-drive" min="0.1"
                                                            max="1" step="0.05" value="0.5">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Compressor -->
                                        <div class="effect-toggle-card">
                                            <div class="effect-toggle-header">
                                                <i class="fas fa-compress-alt"></i>
                                                <span data-i18n="ui.dashboard.effects.compressor">Compressor</span>
                                                <div class="effect-header-controls">
                                                    <button class="effect-advanced-btn" data-effect="compressor"
                                                        title="Advanced Controls"
                                                        data-i18n-title="ui.dashboard.effects.advancedControls">
                                                        <i class="fas fa-cog"></i>
                                                    </button>
                                                    <label class="toggle-switch-v2 small">
                                                        <input type="checkbox" id="effect-compressor-enabled">
                                                        <span class="toggle-track"><span
                                                                class="toggle-thumb"></span></span>
                                                    </label>
                                                </div>
                                            </div>
                                            <div class="effect-toggle-controls" id="effect-compressor-controls">
                                                <div class="effect-intensity-control">
                                                    <div class="mini-control-header">
                                                        <span
                                                            data-i18n="ui.dashboard.effects.intensity">Intensity</span>
                                                        <span class="mini-value"
                                                            id="effect-compressor-intensity-value-adv">0%</span>
                                                    </div>
                                                    <input type="range" id="effect-compressor-intensity-adv" min="0"
                                                        max="100" step="5" value="0">
                                                </div>
                                                <div class="effect-advanced-controls" id="effect-compressor-advanced"
                                                    style="display: none;">
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.thresh">Thresh</span>
                                                            <span class="mini-value">-20dB</span>
                                                        </div>
                                                        <input type="range" id="effect-compressor-threshold" min="-40"
                                                            max="0" step="1" value="-20">
                                                    </div>
                                                    <div class="mini-control">
                                                        <div class="mini-control-header">
                                                            <span data-i18n="ui.dashboard.effects.ratio">Ratio</span>
                                                            <span class="mini-value">4:1</span>
                                                        </div>
                                                        <input type="range" id="effect-compressor-ratio" min="1"
                                                            max="20" step="1" value="4">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Analytics Section -->
            <section id="stats" class="card full-width collapsed">
                <div class="card-header" style="justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <i class="fas fa-chart-line"></i>
                        <h2 data-i18n="ui.dashboard.analytics.title">Analytics</h2>
                    </div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <!-- Detailed Stats Tabs -->
                        <div class="stats-tabs">
                            <button class="stats-tab-btn active" data-tab="overview">
                                <i class="fas fa-chart-pie"></i> <span
                                    data-i18n="ui.dashboard.analytics.overview">Overview</span>
                            </button>
                            <button class="stats-tab-btn" data-tab="requesters">
                                <i class="fas fa-users"></i> <span data-i18n="ui.dashboard.analytics.topRequesters">Top
                                    Requesters</span>
                            </button>
                            <button class="stats-tab-btn" data-tab="history">
                                <i class="fas fa-history"></i> <span
                                    data-i18n="ui.dashboard.analytics.recentHistory">Recent History</span>
                            </button>
                        </div>
                        <button id="stats-collapse-btn" class="cyber-btn small" title="Expand Analytics"
                            style="width: auto; padding: 8px;" data-i18n-title="ui.dashboard.analytics.expandAnalytics">
                            <i class="fas fa-chevron-up"></i>
                        </button>
                    </div>
                </div>

                <!-- Quick Stats Overview -->
                <div class="stats-grid">
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <div class="stat-content">
                            <div class="stat-label" data-i18n="ui.dashboard.analytics.uptime">UPTIME</div>
                            <div class="stat-value" id="uptime-value">0h 0m</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-music"></i>
                        <div class="stat-content">
                            <div class="stat-label" data-i18n="ui.dashboard.analytics.songsPlayed">SONGS PLAYED</div>
                            <div class="stat-value" id="songs-played-value">0</div>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-list"></i>
                        <div class="stat-content">
                            <div class="stat-label" data-i18n="ui.dashboard.analytics.inQueue">IN QUEUE</div>
                            <div class="stat-value" id="queue-count-value">0</div>
                        </div>
                    </div>
                </div>

                <!-- Tab Contents -->
                <div class="stats-tab-content active" id="tab-overview">
                    <div class="stats-overview">
                        <p class="stats-placeholder"><i class="fas fa-spinner fa-spin"></i> <span
                                data-i18n="ui.dashboard.analytics.loadingAnalytics">Loading analytics...</span></p>
                    </div>
                </div>

                <div class="stats-tab-content" id="tab-requesters">
                    <div class="requesters-list">
                        <p class="stats-placeholder" data-i18n="ui.dashboard.analytics.topRequestersPlaceholder">Top
                            requesters will appear here</p>
                    </div>
                </div>

                <div class="stats-tab-content" id="tab-history">
                    <div class="history-list">
                        <p class="stats-placeholder" data-i18n="ui.dashboard.analytics.historyPlaceholder">Playback
                            history will appear here</p>
                    </div>
                </div>
            </section>

            <section id="settings" class="card full-width vip-section-new">
                <!-- Password Unlock Overlay -->
                <div class="vip-unlock-overlay-new" id="vip-unlock-overlay">
                    <div class="vip-unlock-card">
                        <div class="vip-unlock-header">
                            <div class="vip-unlock-icon-new">
                                <i class="fas fa-crown"></i>
                            </div>
                            <div class="vip-unlock-text">
                                <h3 data-i18n="ui.dashboard.vip.management">VIP Management</h3>
                                <p data-i18n="ui.dashboard.vip.enterPassword">Enter password to manage priority users
                                </p>
                            </div>
                        </div>
                        <form id="vip-unlock-form" class="vip-unlock-form" onsubmit="unlockVipArea(event)">
                            <div class="vip-password-input-wrapper">
                                <i class="fas fa-key"></i>
                                <input type="password" id="vip-password" placeholder="Admin password..."
                                    autocomplete="off" data-i18n-placeholder="ui.dashboard.vip.passwordPlaceholder">
                                <button type="button" class="vip-password-toggle"
                                    onclick="toggleVipPasswordVisibility()">
                                    <i class="fas fa-eye" id="vip-password-eye"></i>
                                </button>
                            </div>
                            <button type="submit" class="vip-unlock-btn">
                                <i class="fas fa-unlock"></i>
                                <span data-i18n="ui.dashboard.vip.unlockArea">Unlock VIP Area</span>
                            </button>
                        </form>
                        <p class="vip-password-error" id="vip-password-error"></p>
                    </div>
                </div>

                <!-- Unlocked VIP Content -->
                <div class="vip-content-new" id="vip-content-wrapper">
                    <!-- Header Row -->
                    <div class="vip-top-bar">
                        <div class="vip-title-section">
                            <div class="vip-icon-badge">
                                <i class="fas fa-crown"></i>
                            </div>
                            <div class="vip-title-text">
                                <h2 data-i18n="ui.dashboard.vip.access">VIP Access</h2>
                                <span class="vip-subtitle" data-i18n="ui.dashboard.vip.subtitle">Priority queue for
                                    selected users</span>
                            </div>
                        </div>
                        <div class="vip-actions">
                            <div class="vip-mode-toggle">
                                <button type="button" class="vip-mode-btn active" id="toggle-group-select"
                                    onclick="showGroupSelector()">
                                    <i class="fas fa-users"></i>
                                    <span data-i18n="ui.dashboard.vip.group">Group</span>
                                </button>
                                <button type="button" class="vip-mode-btn" id="toggle-manual-input"
                                    onclick="showManualInput()">
                                    <i class="fas fa-keyboard"></i>
                                    <span data-i18n="ui.dashboard.vip.manual">Manual</span>
                                </button>
                            </div>
                            <button type="button" class="vip-lock-btn-new" id="vip-lock-btn" onclick="lockVipArea()"
                                title="Lock VIP Area" data-i18n-title="ui.dashboard.vip.lockArea">
                                <i class="fas fa-lock"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Main Content Grid -->
                    <div class="vip-grid">
                        <!-- Left: Add VIP -->
                        <div class="vip-add-panel">
                            <div class="vip-panel-header">
                                <i class="fas fa-user-plus"></i>
                                <span data-i18n="ui.dashboard.vip.addUser">Add VIP User</span>
                            </div>

                            <!-- Group member selector -->
                            <div id="group-selector-container" class="vip-selector-container">
                                <div class="vip-search-box">
                                    <i class="fas fa-search"></i>
                                    <input type="text" id="member-search" placeholder="Search members..."
                                        oninput="filterMembers()"
                                        data-i18n-placeholder="ui.dashboard.vip.searchMembers">
                                </div>
                                <div id="members-list" class="vip-members-list">
                                    <div class="vip-loading">
                                        <i class="fas fa-circle-notch fa-spin"></i>
                                        <span data-i18n="ui.dashboard.vip.loadingMembers">Loading members...</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Manual input form (hidden by default) -->
                            <form id="add-vip-form" class="vip-manual-form hidden">
                                <div class="vip-manual-input-wrapper">
                                    <i class="fas fa-phone"></i>
                                    <input type="text" id="vip-id" placeholder="5511999999999@s.whatsapp.net" required
                                        data-i18n-placeholder="ui.dashboard.vip.vipIdPlaceholder">
                                </div>
                                <button type="submit" class="vip-add-btn">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </form>
                        </div>

                        <!-- Right: Current VIPs -->
                        <div class="vip-list-panel">
                            <div class="vip-panel-header">
                                <i class="fas fa-star"></i>
                                <span data-i18n="ui.dashboard.vip.currentVips">Current VIPs</span>
                                <span class="vip-count-badge" id="vip-count-badge">0</span>
                            </div>
                            <ul id="vip-list" class="vip-users-list">
                                <!-- VIP users here -->
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

        </main>

        <footer class="main-footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <i class="fas fa-leaf"></i>
                    <span>Wabi<span class="highlight">Saby</span></span>
                </div>
                <div class="footer-info">
                    <span class="footer-version">v1.0.0</span>
                    <span class="footer-separator"></span>
                    <a href="https://github.com/JoaoAJMatos" target="_blank" rel="noopener noreferrer"
                        class="footer-copyright" title="Copyright JoaoAJMatos">
                        <span class="footer-author">JoaoAJMatos</span>
                        <span class="footer-year">2024</span>
                    </a>
                    <span class="footer-separator"></span>
                    <a href="https://github.com/JoaoAJMatos/WabiSaby" target="_blank" rel="noopener noreferrer"
                        class="footer-github-link" title="View on GitHub">
                        <i class="fab fa-github"></i>
                        <span>GitHub</span>
                    </a>
                </div>
            </div>
        </footer>

        <!-- Settings Modal - Loaded via component loader -->
        <div data-component="modals/settings.html"></div>

        <!-- Add Track Modal -->
        <div id="add-track-modal" class="modal-overlay">
            <div class="modal-content glass-modal add-track-modal">
                <div class="modal-header">
                    <div class="modal-title">
                        <i class="fas fa-music"></i>
                        <h2 data-i18n="ui.dashboard.modals.addTrack.title">Add Track</h2>
                    </div>
                    <button id="add-track-modal-close" class="modal-close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="add-song-form" class="add-track-form">
                        <div class="track-input-group">
                            <label class="track-input-label">
                                <i class="fas fa-link"></i>
                                <span data-i18n="ui.dashboard.modals.addTrack.songUrlLabel">Song URL or Search</span>
                            </label>
                            <div class="track-input-wrapper">
                                <input type="text" id="song-url" class="track-input"
                                    placeholder="Paste YouTube/Spotify URL or search by name..." required
                                    autocomplete="off"
                                    data-i18n-placeholder="ui.dashboard.modals.addTrack.songUrlPlaceholder">
                                <div class="track-platforms">
                                    <span class="track-platform" title="YouTube supported"
                                        data-i18n-title="ui.dashboard.modals.addTrack.youtubeSupported"><i
                                            class="fab fa-youtube"></i></span>
                                    <span class="track-platform" title="Spotify supported"
                                        data-i18n-title="ui.dashboard.modals.addTrack.spotifySupported"><i
                                            class="fab fa-spotify"></i></span>
                                </div>
                            </div>
                        </div>
                        <div class="track-input-group">
                            <label class="track-input-label">
                                <i class="fas fa-user"></i>
                                <span data-i18n="ui.dashboard.modals.addTrack.requestedBy">Requested By</span> <span
                                    class="optional-tag"
                                    data-i18n="ui.dashboard.modals.addTrack.optional">Optional</span>
                            </label>
                            <input type="text" id="requester-name" class="track-input dj-field"
                                placeholder="Your name or DJ alias..." autocomplete="off"
                                data-i18n-placeholder="ui.dashboard.modals.addTrack.requesterPlaceholder">
                        </div>
                        <button type="submit" class="cyber-btn primary track-submit-btn">
                            <i class="fas fa-plus"></i> <span data-i18n="ui.dashboard.modals.addTrack.addToQueue">Add to
                                Queue</span>
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmation-modal" class="modal-overlay">
            <div class="modal-content glass-modal confirmation-modal">
                <div class="modal-header">
                    <div class="modal-title">
                        <i id="confirmation-icon" class="fas fa-exclamation-triangle"></i>
                        <h2 id="confirmation-title" data-i18n="ui.dashboard.modals.confirmation.title">Confirm Action
                        </h2>
                    </div>
                    <button id="confirmation-modal-close" class="modal-close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <p id="confirmation-message" class="confirmation-message"></p>
                </div>
                <div class="modal-footer confirmation-footer">
                    <button id="confirmation-cancel" class="cyber-btn secondary confirmation-btn">
                        <i class="fas fa-times"></i> <span
                            data-i18n="ui.dashboard.modals.confirmation.cancel">Cancel</span>
                    </button>
                    <button id="confirmation-confirm" class="cyber-btn primary confirmation-btn confirm-action-btn">
                        <i class="fas fa-check"></i> <span
                            data-i18n="ui.dashboard.modals.confirmation.confirm">Confirm</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Countdown Song Selection Modal -->
        <div data-component="modals/countdown-song.html"></div>
    </div>

    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>

    <!-- Component Loader -->
    <script src="../js/core/component-loader.js"></script>
    
    <!-- Load Components - Must complete before other scripts run -->
    <script>
        (async function() {
            // Wait for DOM to be ready
            if (document.readyState === 'loading') {
                await new Promise(resolve => document.addEventListener('DOMContentLoaded', resolve));
            }
            
            // Load all components
            const components = document.querySelectorAll('[data-component]');
            const loadPromises = [];
            
            for (const component of components) {
                const componentPath = component.getAttribute('data-component');
                loadPromises.push(componentLoader.load(componentPath, component, 'replace'));
            }
            
            // Wait for all components to load
            await Promise.all(loadPromises);
            
            // Dispatch event to signal components are loaded
            window.dispatchEvent(new CustomEvent('componentsLoaded'));
        })();
    </script>

    <!-- Core Modules (no dependencies) -->
    <script src="../js/core/config.js"></script>
    <script src="../js/config/languages.js"></script>
    <script src="../js/core/utils.js"></script>
    <script src="../js/core/i18n.js"></script>

    <!-- Core Modules (with dependencies) -->
    <script src="../js/core/broadcast.js"></script>
    <script src="../js/core/api.js"></script>

    <!-- Feature Modules -->
    <script src="../js/modules/notifications.js"></script>
    <script src="../js/modules/modals.js"></script>
    <script src="../js/modules/ui.js"></script>
    <script src="../js/modules/audio.js"></script>
    <script src="../js/modules/queue.js"></script>
    <script src="../js/modules/vip.js"></script>
    <script src="../js/modules/settings.js"></script>
    <script src="../js/modules/effects.js"></script>
    <script src="../js/modules/volume.js"></script>
    <script src="../js/modules/volume-normalization.js"></script>
    <script src="../js/modules/countdown-waveform.js"></script>
    <script src="../js/modules/stats.js"></script>
    <script src="../js/modules/groups.js"></script>
    <script src="../js/modules/fullscreen.js"></script>

    <!-- Main Dashboard (orchestration) - waits for components -->
    <script>
        // Wait for components to load before initializing dashboard
        window.addEventListener('componentsLoaded', function() {
            const script = document.createElement('script');
            script.src = '../js/pages/dashboard.js';
            document.body.appendChild(script);
        });
    </script>
</body>

</html>